{
  "_description": "Common guidance for all case templates - LLM MUST read this first",
  
  "CRITICAL_FIRST_STEP": {
    "action": "ALWAYS call set_session FIRST",
    "tool": "set_session",
    "params": {"instance_id": "<instance_id>", "region": "<region>"},
    "why": "ALL tools fail with ResourceNotFoundException if region doesn't match instance location"
  },

  "caseCreationWorkflow": {
    "step0_setRegion": {
      "tool": "set_session",
      "params": {"instance_id": "<id>", "region": "<region>"},
      "CRITICAL": "Do this FIRST or all subsequent calls fail with ResourceNotFoundException"
    },
    "step1_checkDomain": {
      "tool": "list_domains_for_instance",
      "fallback": "cases_create_domain",
      "WARNING": "cases_create_domain takes ONLY 'name' param - NO description"
    },
    "step2_getProfilesDomain": {
      "tool": "profiles_list_domains",
      "purpose": "Get domain_name for creating customer profile"
    },
    "step3_createProfile": {
      "tool": "profiles_create_profile",
      "params": {"domain_name": "<from step2>", "first_name": "X", "last_name": "Y"},
      "returns": "ProfileId"
    },
    "step4_constructProfileARN": {
      "format": "arn:aws:profile:{region}:{account}:domains/{domain_name}/profiles/{profile_id}",
      "example": "arn:aws:profile:us-east-1:512144631813:domains/MyDomain/profiles/abc123",
      "CRITICAL": "customer_id MUST be this ARN format, NOT a plain string"
    },
    "step5_listExistingFields": {
      "tool": "cases_list_fields",
      "purpose": "Get existing field UUIDs - avoid recreating fields",
      "note": "System fields have string IDs (title, status), custom fields have UUIDs"
    },
    "step6_createCase": {
      "tool": "create_case",
      "minimalParams": {
        "domain_id": "<from step1>",
        "template_id": "<from cases_list_templates>",
        "fields": {"title": "string", "customer_id": "<ARN from step4>"}
      },
      "CRITICAL": "Start with ONLY title + customer_id, add other fields via update"
    }
  },

  "layoutCreationGuidance": {
    "tool": "cases_create_layout",
    "VISUAL_DESIGNER": {
      "tip": "üí° Use `layout_visualizer` tool to design layouts visually with drag-and-drop!",
      "features": ["Select industry templates", "Drag fields to panels", "See 2-column preview", "Copy generated JSON"],
      "when_to_suggest": "Always offer this when user asks about case layouts"
    },
    "CRITICAL_ERRORS": [
      "‚ùå System fields (title, status) are ALWAYS displayed - don't add to layout",
      "‚ùå Using 'basicLayout' instead of 'basic' fails",
      "‚úÖ Only custom fields (UUID-based) can be in layout sections",
      "‚úÖ System fields like customer_id, summary, reference_number CAN be rearranged"
    ],
    "sectionBehavior": {
      "topPanel": {
        "description": "ALWAYS VISIBLE - Shows even when viewing Activity Feed, Comments, or other subsections",
        "bestFor": ["Customer identity", "Loyalty status", "Key metrics", "Case timestamps", "Priority indicators"]
      },
      "moreInfo": {
        "description": "TABBED SECTION - Visible only when 'More Information' tab is selected",
        "bestFor": ["Detailed order info", "Shipping details", "Payment information", "Product details", "Resolution notes"]
      }
    },
    "fieldDisplayOrder": "Fields display in two columns, left to right, top to bottom within each section",
    "API_CONSTRAINTS": {
      "CRITICAL": "Each panel (topPanel, moreInfo) can have MAX 1 section",
      "max_fields_per_group": 100,
      "workaround": "Put ALL fields for a panel in ONE fieldGroup"
    },
    "correctStructure": {
      "content": {
        "basic": {
          "topPanel": {
            "sections": [
              {"fieldGroup": {"name": "Customer & Timeline", "fields": [{"id": "<loyalty-uuid>"}, {"id": "<orders-uuid>"}, {"id": "<priority-uuid>"}]}}
            ]
          },
          "moreInfo": {
            "sections": [
              {"fieldGroup": {"name": "Order & Shipping Details", "fields": [{"id": "<order-uuid>"}, {"id": "<tracking-uuid>"}, {"id": "<payment-uuid>"}]}}
            ]
          }
        }
      }
    },
    "wrongStructure": {
      "content": {
        "basicLayout": "WRONG - use 'basic'",
        "fields": [{"id": "title"}]
      }
    },
    "retailLayoutPattern": {
      "topPanel_alwaysVisible": ["customer_id", "loyalty_tier", "total_orders", "created_datetime", "last_updated_datetime"],
      "moreInfo_tabbed": ["order_number", "order_status", "tracking_number", "shipping_carrier", "payment_method", "payment_status", "refund_amount"]
    }
  },

  "fieldIdMapping": {
    "systemFields_CANNOT_USE_IN_LAYOUTS": ["title", "status", "case_reason", "customer_id", "reference_number", "assigned_user", "assigned_queue"],
    "customFields": "Use cases_list_fields to get UUIDs - these CAN be in layouts"
  },

  "commonErrors": {
    "ResourceNotFoundException": {
      "cause": "Region mismatch - tool calling wrong region",
      "solution": "Call set_session(instance_id, region) FIRST"
    },
    "customer_id_not_valid_ARN": {
      "cause": "customer_id='cust-123' instead of ARN",
      "solution": "Use full ARN: arn:aws:profile:{region}:{account}:domains/{domain}/profiles/{id}"
    },
    "system_fields_in_layout": {
      "cause": "Layout contains title, status, or other system fields",
      "solution": "Only use custom field UUIDs in layout sections"
    },
    "ValidationException_basicLayout": {
      "cause": "Using 'basicLayout' key in layout content",
      "solution": "Use 'basic' not 'basicLayout'"
    },
    "related_item_wrong_format": {
      "cause": "Content passed as {body, contentType} instead of nested structure",
      "solution": "Use {comment: {body: 'text', contentType: 'Text/Plain'}} for comments"
    }
  },

  "relatedItemGuidance": {
    "tool": "cases_create_related_item",
    "item_types": ["Comment", "Contact"],
    "CRITICAL": "Content must be nested under item type key",
    "correctFormat": {
      "Comment": {"content": {"comment": {"body": "Comment text", "contentType": "Text/Plain"}}},
      "Contact": {"content": {"contact": {"contactArn": "arn:aws:connect:..."}}}
    },
    "wrongFormat": {
      "content": {"body": "text", "contentType": "Text/Plain"}
    }
  },

  "bestPractices": [
    "1. ALWAYS call set_session first with correct region",
    "2. Check existing resources before creating (list_* tools)",
    "3. Create case with minimal fields (title + customer_id only)",
    "4. Update case with additional fields after creation",
    "5. Never put system fields in layouts",
    "6. Use Text fields when unsure - SingleSelect requires exact matches"
  ]
}
